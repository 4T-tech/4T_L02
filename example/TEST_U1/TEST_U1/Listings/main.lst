C51 COMPILER V9.60.7.0   MAIN                                                              09/28/2025 15:21:37 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\TEST_U1) DEBUG OBJECTEXTEND PR
                    -INT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "stc12.h"
   2          #include <intrins.h>
   3          #include <string.h>
   4          /*
   5          1.ledÈýÈ¦µÆ£¬¿ÉÒÔÇÐ»»³ÉÁíÒ»ÖÖ¹Û²ìÒ»ÏÂ
   6          2.¿´SW2ºÍSW24µÄ²¦¶¯¿ª¹Ø£¬ÍùÉÏµÄ»°·äÃùÆ÷ºÍµãÕó¶¼»áÔÚÓÃ
   7          */
   8          #define uint8_t  unsigned char
   9          #define uint16_t unsigned int
  10            
  11          
  12          /*´®ÐÐÊý¾Ý*/
  13          sbit SER = P3^5;
  14          sbit SRCLK = P3^6;            //ÒÆÎ»¼Ä´æÆ÷µÄÊ±ÖÓÊäÈë,µ±½ÓÊÕµ½ÉÏÉýÑØÊ±ÒÆÎ»¼Ä´æÆ÷ÄÚ²¿Êý¾ÝÕûÌåºóÒÆ;
  15          sbit SRCLR = P3^7;            //¸´Î»Òý½Å,µ±Òý½Å½ÓµÍµçÆ½Ê±Ð¾Æ¬ÄÚ²¿Êý¾Ý´æ´¢¼Ä´æÆ÷Êý¾ÝÇåÁã¸´Î».Èç²»Ê¹ÓÃÒ»°ã½Ó¸ßµçÆ
             -½;
  16          sbit RCLK = P3^4;             //Êý¾Ý´æ´¢¼Ä´æÆ÷Ê±ÖÓÊäÈë,µ±¼ì²âµ½ÉÏÉýÑØÊ±Ê¹ÄÜÊý¾Ý´æ´¢¼Ä´æÆ÷
  17          /*4-16ÒëÂëÆ÷*/
  18          sbit A0 = P2^6;
  19          sbit A1 = P2^7;
  20          sbit A2 = P3^2;
  21          sbit A3 = P3^3;
  22          sbit E0 = P2^5;
  23          
  24          sbit S_L=P2^0;
  25          sbit S_R=P2^1;
  26          sbit beep=P2^3;
  27          
  28          
  29          unsigned char code led[10][8] = { 
  30                                            {0x18,0x24,0x24,0x24,0x24,0x24,0x24,0x18},//0
  31                                            {0x00,0x18,0x1c,0x18,0x18,0x18,0x18,0x18},//1
  32                                            {0x00,0x1e,0x30,0x30,0x1c,0x06,0x06,0x3e},//2
  33                                            {0x00,0x1e,0x30,0x30,0x1c,0x30,0x30,0x1e},//3
  34                                            {0x00,0x30,0x38,0x34,0x32,0x3e,0x30,0x30},//4
  35                                            {0x00,0x1e,0x02,0x1e,0x30,0x30,0x30,0x1e},//5
  36                                            {0x00,0x1c,0x06,0x1e,0x36,0x36,0x36,0x1c},//6
  37                                            {0x00,0x3f,0x30,0x18,0x18,0x0c,0x0c,0x0c},//7
  38                                            {0x00,0x1c,0x36,0x36,0x1c,0x36,0x36,0x1c},//8
  39                                            {0x00,0x1c,0x36,0x36,0x36,0x3c,0x30,0x1c} //9
  40                                          };
  41          
  42          void delay(unsigned int i);   //ÑÓÊ±º¯ÊýÉùÃ÷
  43          void send_serial_data(unsigned int tdata);
  44          void set_row(unsigned char row);
  45                                          
  46                                          
  47          void led_running();
  48          
  49          void main()
  50          {
  51   1        uint8_t i,j,p;
  52   1      
  53   1        led_running();
C51 COMPILER V9.60.7.0   MAIN                                                              09/28/2025 15:21:37 PAGE 2   

  54   1      
  55   1        beep = 0; 
  56   1      
  57   1      
  58   1        while(1)
  59   1        {   
  60   2          for(j=0;j<10;j++)
  61   2          {
  62   3            if(S_R == 1 )
  63   3            {
  64   4      
  65   4              for(p=0;p<10;p++)
  66   4              for(i=0;i<8;i++)
  67   4              {   
  68   5                E0 = 1;
  69   5                send_serial_data(led[j][i]);
  70   5                E0 = 0;
  71   5                set_row(i);
  72   5                if(S_L == 1)
  73   5                {
  74   6                  beep = 0;
  75   6                  delay(500);
  76   6                  beep = 1;
  77   6                }
  78   5                else
  79   5                {
  80   6                  delay(500);
  81   6                  beep = 1;
  82   6                }
  83   5              } 
  84   4            }
  85   3            else
  86   3            {
  87   4              E0 = 1;
  88   4              if(S_L == 1)
  89   4              {
  90   5                beep = 0;
  91   5                delay(500);
  92   5                beep = 1;
  93   5              }
  94   4              else
  95   4              {
  96   5                beep = 1;
  97   5              }
  98   4              delay(300);
  99   4            }
 100   3          }
 101   2        }
 102   1      
 103   1      
 104   1      
 105   1      }
 106          
 107          
 108          
 109          void delay_ms(uint16_t times) //@11.0592MHz
 110          {
 111   1        unsigned char data i, j;
 112   1        uint16_t k;
 113   1        for(k=0;k<times;k++)
 114   1        {
 115   2          _nop_();
C51 COMPILER V9.60.7.0   MAIN                                                              09/28/2025 15:21:37 PAGE 3   

 116   2          i = 11;
 117   2          j = 190;
 118   2          do
 119   2          {
 120   3            while (--j);
 121   3          } while (--i);
 122   2        }
 123   1      }
 124          
 125          void led_running()
 126          {
 127   1        uint8_t i,j;
 128   1        uint8_t led_flag = 0xfe;
 129   1        for(j=0;j<3;j++)
 130   1        for(i=0;i<8;i++)
 131   1        {
 132   2          P0 = led_flag;
 133   2          led_flag =_crol_(led_flag,1);
 134   2          delay_ms(100);
 135   2        }
 136   1        
 137   1        P0 = 0xff;
 138   1        
 139   1        
 140   1      }
 141          
 142          //º¯ÊýÃû£ºdelay
 143          //º¯Êý¹¦ÄÜ£ºÊµÏÖÈí¼þÑÓÊ±
 144          //ÐÎÊ½²ÎÊý£ºÎÞ·ûºÅÕûÐÍ±äÁ¿i£¬¿ØÖÆ¿ÕÑ­»·µÄÑ­»·´ÎÊý
 145          //·µ»ØÖµ£ºÎÞ
 146          void delay(unsigned int i)    //ÑÓÊ±º¯Êý
 147          {
 148   1        unsigned int k;
 149   1        for(k=0;k<i;k++);
 150   1      }
 151          
 152          /* Çý¶¯74HC595·¢ËÍ´®ÐÐÊý¾Ý */
 153          void send_serial_data(unsigned int tdata)
 154          {
 155   1        unsigned char i;
 156   1        unsigned int serial_data;
 157   1        serial_data = ~tdata;
 158   1        for(i=0;i<8;i++)
 159   1        {
 160   2      
 161   2          SER = (serial_data>>i)&0x01;
 162   2          SRCLK = 0 ;
 163   2          delay(1);
 164   2          SRCLK = 1;
 165   2          delay(1);
 166   2          RCLK = 0;
 167   2          delay(1);
 168   2          RCLK = 1;
 169   2          delay(1);
 170   2      
 171   2        }
 172   1      }
 173          
 174          /* ÉèÖÃÐÐÊý */
 175          void set_row(unsigned char row)
 176          {
 177   1        switch(row)
C51 COMPILER V9.60.7.0   MAIN                                                              09/28/2025 15:21:37 PAGE 4   

 178   1        {
 179   2          case 0 : A3 = 0; A2 = 0; A1 = 0 ;A0 = 0; break;
 180   2          case 1 : A3 = 0; A2 = 0; A1 = 0 ;A0 = 1; break;
 181   2          case 2 : A3 = 0; A2 = 0; A1 = 1 ;A0 = 0; break;
 182   2          case 3 : A3 = 0; A2 = 0; A1 = 1 ;A0 = 1; break;
 183   2          case 4 : A3 = 0; A2 = 1; A1 = 0 ;A0 = 0; break;
 184   2          case 5 : A3 = 0; A2 = 1; A1 = 0 ;A0 = 1; break;
 185   2          case 6 : A3 = 0; A2 = 1; A1 = 1 ;A0 = 0; break;
 186   2          case 7 : A3 = 0; A2 = 1; A1 = 1 ;A0 = 1; break;
 187   2          default : break;
 188   2        }
 189   1        
 190   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    383    ----
   CONSTANT SIZE    =     80    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       7
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
